<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tabla General — United Clubs Soccer League</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&family=Montserrat:wght@400;600&family=Poppins:wght@600&display=swap" rel="stylesheet">
  <style>
    :root { --primary:#0b2a5b; --accent:#d4af37; --ink:#0f172a; }

    * { box-sizing: border-box; }
    body { margin:0; font-family: Montserrat, Arial, sans-serif; color: var(--ink); background:#f9fafb; }
    a { color:inherit; text-decoration:none; }

    /* NAV (match Inicio) */
    .nav { position:sticky; top:0; z-index:40; background:#fff; border-bottom:3px solid var(--accent); }
    .nav-inner { max-width:1200px; margin:auto; display:flex; align-items:center; justify-content:space-between; padding:10px 16px; }
    .brand h1 { font-family:Oswald, sans-serif; letter-spacing:1px; margin:0; font-size:24px; color:var(--primary); text-transform:uppercase; }
    .navlinks { display:flex; gap:18px; font-weight:600; font-size:14px; }
    .navlinks a { padding:8px 10px; border-radius:8px; }
    .navlinks a:hover { background:#f8fafc; }

    /* Menu wrapper (row, like Inicio) */
    .menu-wrapper { display:none; align-items:center; gap:8px; }
    .menu-label { font-family:Oswald, sans-serif; font-size:14px; font-weight:600; color:var(--primary); }
    .menu-toggle { font-size:22px; font-weight:bold; color:var(--primary); background:none; border:none; cursor:pointer; }

    /* TABLE CARD */
    .standings { max-width:1100px; margin:40px auto; background:#fff; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); overflow-x:auto; }
    table { width:100%; border-collapse:collapse; font-size:14px; text-align:center; }
    thead { background:var(--primary); color:#fff; }
    th, td { padding:10px 6px; border:1px solid #e2e8f0; }
    th { font-weight:600; font-size:13px; }
    td:first-child, th:first-child { font-weight:600; }
    td:nth-child(2) { text-align:left; white-space:nowrap; }
    .criteria { text-align:center; margin:10px auto 0; font-size:13px; color:#64748b; padding:0 12px; }

    .status { text-align:center; padding:14px; color:#64748b; }

    footer { padding:20px 16px; border-top:3px solid var(--accent); text-align:center; color:#64748b; margin-top:40px; }

    /* MOBILE (match Inicio) */
    @media (max-width: 768px) {
      .navlinks {
        display:none;
        flex-direction:column;
        gap:8px;
        background:#fff;
        padding:8px;
        position:absolute;
        top:60px;
        right:16px;
        border:1px solid var(--accent);
        border-radius:6px;
      }
      .navlinks.active { display:flex; }
      .menu-wrapper { display:flex; }        /* row, not stacked */
      .brand h1 { font-size:18px; }          /* same as Inicio mobile */
      table { font-size:12px; }
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <div class="nav">
    <div class="nav-inner">
      <div class="brand"><h1>United Clubs Soccer League</h1></div>
      <!-- Mobile Menu -->
      <div class="menu-wrapper">
        <div class="menu-label">Menu</div>
        <button class="menu-toggle" onclick="toggleMenu()">☰</button>
      </div>
      <nav class="navlinks" id="navLinks">
        <a href="index.html">Inicio</a>
        <a href="tabla.html">Tabla</a>
        <a href="horario.html">Horario de Partidos</a>
        <a href="resultados.html">Resultados</a>
        <a href="goleadores.html">Goleadores</a>
        <a href="cedula.html">Cédula</a>
        <a href="sobrelaliga.html">Sobre la Liga</a>
      </nav>
    </div>
  </div>

  <!-- TABLE -->
  <section class="standings">
    <h2 style="text-align:center; font-family:Poppins, sans-serif; margin:20px 0; color:var(--primary);">Tabla General</h2>
    <p class="criteria">Criterios de desempate: PTS → DIF → GF → Resultados entre equipos</p>

    <div id="status" class="status">Cargando tabla…</div>

    <div id="table-container" style="display:none; overflow-x:auto;">
      <table id="standings-table" aria-label="Tabla General">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <footer>© <span id="y"></span> United Clubs Soccer League — Santa Ana, CA</footer>
<script>
  document.getElementById('y').textContent = new Date().getFullYear();
  function toggleMenu() {
    document.getElementById('navLinks').classList.toggle('active');
  }

  // === LIVE CSV → TABLE (right-side table only) ===
  const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTxW6zuoPjfDDf45S2RII9krWfSpybm-QEWx5_jeF9hYF5Do2Ax-OQNVvbDv4FYlRuoyRySHFTGdgVb/pub?gid=870919127&single=true&output=csv";

  // Robust-ish CSV split (handles commas inside quotes)
  function parseCSV(text) {
    const rows = text.trim().split(/\r?\n/);
    return rows.map(row => {
      const cells = [];
      let cur = "", inQuotes = false;
      for (let i = 0; i < row.length; i++) {
        const ch = row[i];
        if (ch === '"') {
          if (inQuotes && row[i+1] === '"') { cur += '"'; i++; }
          else { inQuotes = !inQuotes; }
        } else if (ch === ',' && !inQuotes) {
          cells.push(cur); cur = "";
        } else {
          cur += ch;
        }
      }
      cells.push(cur);
      return cells.map(c => c.trim());
    });
  }

  async function loadStandings() {
    const status = document.getElementById('status');
    const container = document.getElementById('table-container');
    const table = document.getElementById('standings-table');
    const thead = table.querySelector('thead');
    const tbody = table.querySelector('tbody');

    try {
      const res = await fetch(CSV_URL, { cache: "no-store" });
      if (!res.ok) throw new Error("No se pudo obtener el CSV");
      const csvText = await res.text();
      const all = parseCSV(csvText);
      if (!all.length) throw new Error("CSV vacío");

      // Find the start of the RIGHT table: header sequence "POS, Team, PJ, ..."
      const header = all[0].map(h => h.toUpperCase());
      let start = -1;
      for (let i = 0; i < header.length - 1; i++) {
        if (header[i] === "POS" && (header[i+1] === "TEAM" || header[i+1] === "EQUIPO")) {
          start = i;
          break;
        }
      }
      // If not found, fallback to the last 11 columns (right block is 11 wide)
      const width = 10; // POS, Team, PJ, G, E, P, GF, GC, DIF, PTS
      if (start === -1) start = Math.max(0, header.length - width);

      // Slice every row to only the right-hand block
      const sliced = all.map(r => r.slice(start, start + width));

      // Build header/body
      thead.innerHTML = "<tr>" + sliced[0].map(h => `<th>${h}</th>`).join("") + "</tr>";
      tbody.innerHTML = sliced.slice(1)
        .filter(r => r.some(c => c && c.length))
        .map(r => "<tr>" + r.map((c,i) => {
          if (i === 0) return `<td style="font-weight:700">${c}</td>`; // POS bold
          if (i === 1) return `<td style="text-align:left; white-space:nowrap">${c}</td>`; // Team left
          return `<td>${c}</td>`;
        }).join("") + "</tr>")
        .join("");

      status.style.display = "none";
      container.style.display = "block";
    } catch (err) {
      status.textContent = "Error cargando la tabla. Intenta de nuevo más tarde.";
      console.error(err);
    }
  }

  loadStandings();
</script>
</body>
</html>

